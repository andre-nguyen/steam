//////////////////////////////////////////////////////////////////////////////////////////////
/// \file BlockMatrixBase.cpp
///
/// \author Sean Anderson, ASRL
//////////////////////////////////////////////////////////////////////////////////////////////

#include <steam/sparse/BlockMatrixBase.hpp>

#include <stdexcept>
#include <iostream>

namespace steam {

//////////////////////////////////////////////////////////////////////////////////////////////
/// \brief Default constructor, matrix size must still be set before using
//////////////////////////////////////////////////////////////////////////////////////////////
BlockMatrixBase::BlockMatrixBase(bool square, bool symmetric)
  : square_(square), symmetric_(symmetric) {

  if (!square_ && symmetric_) {
    throw std::invalid_argument("Tried to construct a symmetric matrix that is not square.");
  }
}

//////////////////////////////////////////////////////////////////////////////////////////////
/// \brief Rectangular matrix constructor
//////////////////////////////////////////////////////////////////////////////////////////////
BlockMatrixBase::BlockMatrixBase(const std::vector<unsigned int>& blkRowSizes,
                                 const std::vector<unsigned int>& blkColSizes)
  : square_(false), symmetric_(false) {

  if (blkColSizes.size() <= 0) {
    throw std::invalid_argument("Tried to initialize a block matrix with no column size.");
  }
  if (blkRowSizes.size() <= 0) {
    throw std::invalid_argument("Tried to initialize a block matrix with no row size.");
  }

  // Setup indexing
  indexing_ = BlockMatrixIndexing(blkRowSizes, blkColSizes);
}

//////////////////////////////////////////////////////////////////////////////////////////////
/// \brief Square matrix constructor, symmetry is still optional
//////////////////////////////////////////////////////////////////////////////////////////////
BlockMatrixBase::BlockMatrixBase(const std::vector<unsigned int>& blkSqSizes, bool symmetric)
  : square_(true), symmetric_(symmetric) {

  if (blkSqSizes.size() <= 0) {
    throw std::invalid_argument("Tried to initialize a block matrix with no row size.");
  }

  // Setup indexing
  indexing_ = BlockMatrixIndexing(blkSqSizes);
}

//////////////////////////////////////////////////////////////////////////////////////////////
/// \brief Get indexing object
//////////////////////////////////////////////////////////////////////////////////////////////
const BlockMatrixIndexing& BlockMatrixBase::getIndexing() const {
  return indexing_;
}

//////////////////////////////////////////////////////////////////////////////////////////////
/// \brief Get if square
//////////////////////////////////////////////////////////////////////////////////////////////
bool BlockMatrixBase::isSquare() const {
  return square_;
}

//////////////////////////////////////////////////////////////////////////////////////////////
/// \brief Get if symmetric
//////////////////////////////////////////////////////////////////////////////////////////////
bool BlockMatrixBase::isSymmetric() const {
  return symmetric_;
}

} // steam
